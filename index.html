<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Timothy Fund Uganda | Blog</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Video.js CSS -->
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
</head>

<body>
    <header class="app-header">
        <div class="header-content">
            <h1 class="logo">Project Timothy Fund <span>Uganda</span></h1>
            <nav id="main-nav">
                <a href="#home" class="nav-link">Latest Post</a>
                <a href="#archive" class="nav-link">Previous Posts</a>
                <div id="admin-link-container"></div>
            </nav>
        </div>
    </header>

    <main id="app-viewport">
        <!-- Views will be injected here -->
        <section id="home-view" class="view">
            <div id="latest-post-container">
                <div class="loader">Loading latest update...</div>
            </div>
        </section>

        <section id="archive-view" class="view hidden">
            <div class="section-header">
                <h2>Previous Posts</h2>
            </div>
            <div id="archive-grid" class="grid"></div>
        </section>

        <section id="post-view" class="view hidden">
            <div id="post-content"></div>
            <div id="comments-section" class="comments-section">
                <h3>Comments</h3>
                <div id="comments-list"></div>
                <form id="comment-form" class="comment-form">
                    <input type="text" id="comment-author" placeholder="Your Name" required>
                    <textarea id="comment-text" placeholder="Leave a comment..." required></textarea>
                    <button type="submit" class="btn btn-primary">Submit Comment</button>
                </form>
            </div>
        </section>

        <section id="admin-login-view" class="view hidden">
            <div class="admin-card">
                <h2>Admin Login</h2>
                <form id="login-form">
                    <input type="email" id="login-email" placeholder="Admin Email" required>
                    <input type="password" id="login-password" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary">Login</button>
                </form>
            </div>
        </section>


        <section id="admin-dashboard-view" class="view hidden">
            <div class="admin-layout">
                <aside class="admin-sidebar">
                    <div class="sidebar-brand">
                        <h3>Admin</h3>
                    </div>
                    <nav class="sidebar-nav">
                        <a href="#admin/posts" class="nav-item" data-route="posts">
                            <span class="nav-icon">üìù</span>
                            <span class="nav-label">Manage Posts</span>
                        </a>
                        <a href="#admin/subscribers" class="nav-item" data-route="subscribers">
                            <span class="nav-icon">üë•</span>
                            <span class="nav-label">Subscribers</span>
                        </a>
                        <a href="#admin/comments" class="nav-item" data-route="comments">
                            <span class="nav-icon">üí¨</span>
                            <span class="nav-label">Moderation</span>
                        </a>
                    </nav>
                    <div class="sidebar-footer">
                        <button id="btn-logout" class="btn btn-text logout-btn">
                            <span class="nav-icon">üö™</span>
                            <span>Logout</span>
                        </button>
                        <div id="storage-usage-sidebar" class="storage-usage-sidebar">
                            <div class="storage-info">
                                <span class="storage-label">Storage:</span>
                                <span id="storage-value">---</span>
                            </div>
                            <button id="btn-refresh-storage" class="btn-refresh"
                                title="Refresh storage usage">üîÑ</button>
                        </div>
                        <div class="app-version">v1.0.012</div>
                    </div>
                </aside>
                <main id="admin-content" class="admin-main">
                    <!-- Admin subsections -->
                </main>
            </div>
        </section>

        <!-- Audio Recorder Modal -->
        <div id="modal-audio-recorder" class="modal hidden">
            <div class="modal-content recorder-modal">
                <h3>Record Audio Snippet</h3>
                <div class="recorder-container">
                    <canvas id="waveform" width="400" height="100"></canvas>
                    <div class="timer" id="recording-timer">00:00</div>
                </div>
                <div class="modal-actions">
                    <button id="btn-start-record" class="btn btn-primary">Start Recording</button>
                    <button id="btn-stop-record" class="btn btn-secondary hidden">Stop</button>
                    <button id="btn-save-record" class="btn btn-primary hidden">Save & Upload</button>
                    <button id="btn-cancel-record" class="btn btn-text">Cancel</button>
                </div>
            </div>
        </div>
        <!-- Video Uploader Modal -->
        <div id="modal-video-uploader" class="modal hidden">
            <div class="modal-content card">
                <h3>Add/Edit Video</h3>
                <div class="input-group" style="margin-top: 1rem;">
                    <label>Video File (MP4, WebM)</label>
                    <div class="upload-zone" id="video-upload-zone">
                        <p>üé• Click to select a video file</p>
                        <input type="file" id="video-file-input" accept="video/*" hidden>
                    </div>
                </div>

                <div class="input-group" style="margin-top: 1rem;">
                    <label>Video Description</label>
                    <textarea id="video-description"
                        placeholder="e.g. This video shows the local community gathering for the update..."
                        style="min-height: 100px;"></textarea>
                </div>

                <div id="video-upload-status" style="margin-top: 1rem; color: var(--color-orange); font-weight: 500;">
                </div>

                <div class="modal-actions">
                    <button class="btn btn-text" id="btn-cancel-video">Cancel</button>
                    <button class="btn btn-primary" id="btn-save-video">Upload & Tag Slide</button>
                    <button class="btn btn-text delete hidden" id="btn-delete-video">Remove Video</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="app-footer">
        <div class="version">v1.0.001</div>
        <p>&copy; 2026 Project Timothy Fund Uganda</p>
    </footer>

    <!-- Custom Notifications Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Custom Confirm Modal -->
    <div id="modal-confirm" class="modal hidden">
        <div class="modal-content card confirm-modal">
            <h3 id="confirm-title">Confirm Action</h3>
            <p id="confirm-message" style="margin: 1.5rem 0; color: var(--color-dark); opacity: 0.8;"></p>
            <div class="modal-actions" style="justify-content: flex-end; gap: 1rem;">
                <button class="btn btn-text" id="btn-confirm-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-confirm-ok">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Custom Prompt Modal -->
    <div id="modal-prompt" class="modal hidden">
        <div class="modal-content card confirm-modal">
            <h3 id="prompt-title">Input Required</h3>
            <p id="prompt-message" style="margin: 1rem 0; color: var(--color-dark); opacity: 0.8;"></p>
            <div class="input-group" style="margin-bottom: 1.5rem;">
                <input type="text" id="prompt-input" style="width: 100%;">
            </div>
            <div class="modal-actions" style="justify-content: flex-end; gap: 1rem;">
                <button class="btn btn-text" id="btn-prompt-cancel">Cancel</button>
                <button class="btn btn-primary" id="btn-prompt-ok">Submit</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <!-- AWS SDK for JavaScript (S3 Client) is loaded dynamically in app.js -->
    <script src="js/config.js"></script>
    <script src="js/app.js"></script>
</body>

</html>